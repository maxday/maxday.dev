<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Have you ever wondered how your Lambda function code is triggered?
Each runtime has to conform to the AWS Lambda runtime API.
In managed runtimes, you don&rsquo;t need to take care of that; that&rsquo;s the whole point of using a managed runtime! AWS takes care of that for you.
But how?
It&rsquo;s hard to say because it&rsquo;s not clearly documented. However, while I was conducting some unrelated experiments, I made a very cool discovery!"><title>How I Discovered That the AWS Lambda Runtime Might Be Written in Go</title><link rel="shortcut icon" type=image/x-icon href=/><link rel=stylesheet href=/css/main.35c42d788ab64156a7083a0054ba19dd8f79eac986fe869b731825c45b8e4a29a63628a438fd2ef54b4d0fa28b4d2d93309a885ccacdb28a54b425aa2ca3224a.css integrity="sha512-NcQteIq2QVanCDoAVLoZ3Y956smG/oabcxglxFuOSimmNiikOP0u9UtND6KLTS2TMJqIXMrNsopUtCWqLKMiSg=="><script defer data-domain=maxday.dev src=https://plausible.io/js/script.js></script><meta name=description content="Software Engineer, Serverless and Rust addict"><meta property="og:url" content="https://maxday.dev"><meta property="og:type" content="website"><meta property="og:title" content="Maxime David | maxday"><meta property="og:description" content="Software Engineer, Serverless and Rust addict"><meta property="og:image" content="https://maxday.dev/og.png"><meta name=twitter:card content="summary_large_image"><meta property="twitter:domain" content="maxday.dev"><meta property="twitter:url" content="https://maxday.dev"><meta name=twitter:title content="Maxime David | maxday"><meta name=twitter:description content="Software Engineer, Serverless and Rust addict"><meta name=twitter:image content="https://maxday.dev/og.png"><meta name=google-site-verification content="RU5jdXdJjFqFrujLcpVYIcMftJNOvEx8GpGjbZs_KP8"><link rel=icon href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ”¥</text></svg>"></head><body a=light><main class=page-content aria-label=Content><div class=w><a href=/>back</a><article><p class=post-meta><time datetime="2023-08-02 00:00:00 +0800 +0800">2023-08</time></p><h1>How I Discovered That the AWS Lambda Runtime Might Be Written in Go</h1><p>Have you ever wondered how your Lambda function code is triggered?</p><p>Each runtime has to conform to the <a href=https://docs.aws.amazon.com/lambda/latest/dg/runtimes-api.html>AWS Lambda runtime API</a>.</p><p>In managed runtimes, you don&rsquo;t need to take care of that; that&rsquo;s the whole point of using a managed runtime! AWS takes care of that for you.</p><p>But how?</p><p>It&rsquo;s hard to say because it&rsquo;s not clearly documented. However, while I was conducting some unrelated experiments, I made a very cool discovery!
I think you&rsquo;ll find it interesting too!</p><p>If you&rsquo;re working with Go and care about performance, you might want to look at some important metrics, such as:</p><ul><li>the number of allocations</li><li>the time taken for each init() functions</li></ul><p>To do so, you need to setup a environment variable:<br><code>GODEBUG</code> to <code>inittrace=1</code>.</p><p>And tada ðŸŽ‰!</p><p>In addition to information about the binary I wanted to test, I&rsquo;m now able to see traces from another binary, which seems to be the one from AWS that conforms to the runtime API.</p><p>Here is an example of the output ðŸ‘€ðŸ‘€ðŸ‘€</p><pre tabindex=0><code>2023-08-02T12:54:02.418-04:00	init internal/bytealg @0.008 ms, 0 ms clock, 0 bytes, 0 allocs
...
2023-08-02T12:54:02.421-04:00	init go.amzn.com/lambda/fatalerror @3.7 ms, 0.031 ms clock, 336 bytes, 2 allocs
...
2023-08-02T12:54:02.424-04:00	init go.amzn.com/lambda/interop @6.5 ms, 0.023 ms clock, 1128 bytes, 32 allocs
2023-08-02T12:54:02.424-04:00	init go.amzn.com/lambda/telemetry @6.5 ms, 0.067 ms clock, 16 bytes, 1 allocs
2023-08-02T12:54:02.424-04:00	init go.amzn.com/lambda/core @6.6 ms, 0.007 ms clock, 224 bytes, 12 allocs
2023-08-02T12:54:02.424-04:00	init go.amzn.com/lambda/rapi/rendering @6.7 ms, 0.086 ms clock, 16 bytes, 1 allocs
2023-08-02T12:54:02.424-04:00	init go.amzn.com/lambda/rapi/handler @6.8 ms, 0 ms clock, 256 bytes, 2 allocs
2023-08-02T12:54:02.424-04:00	init go.amzn.com/lambda/rapid @6.8 ms, 0.099 ms clock, 16 bytes, 1 allocs
...
2023-08-02T12:54:02.432-04:00	INIT_START Runtime Version: nodejs:18.v9 Runtime Version ARN: arn:aws:lambda:us-east-1::runtime:7d5f06b69c951da8a48b926ce280a9daf2e8bb1a74fc4a2672580c787d608206
</code></pre><p>Here, we can clearly see some explicit package names coming from AWS.</p><p>Another important thing to note is that those logs are output BEFORE the <code>INIT_START</code> log line, which provides further evidence that it might be how AWS Lambda is managing your code!</p><p>Voila! ðŸŽ‰
What do you think?</p><p>You can find me on <a href=https://www.linkedin.com/in/maxday/>LinkedIn</a> and <a href=https://twitter.com/_maxday>Twitter</a>!</p></article></div></main></body></html>